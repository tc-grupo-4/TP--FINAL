clearvars;
syms K N P positive;

Q = 1.02;
f0 = 5000;
G = 10^(4/20);

% c2 = 1e-9;

ra = 1e3;
c = 10e-9;

r = sqrt(2)/(2*pi()*f0*c);
k = 4-sqrt(2)/Q;
rb = (k-1)*ra;

r1 = r; r2 = r; r3=r; c1 = c; c2 = c;

f0 = sqrt((1+r1/r3)/(r1*r2*c1*c2))/2/pi();
Q = sqrt(1+r1/r3)/( (1+ (1-k)*r1/r3) *sqrt(r2*c2/r1/c1) + sqrt(r2*c1/r2/c1) + sqrt(r1*c1/r2/c2) );
G = k/(1+ (1-k)*r1/r3 + (1+c1/c2)*r1/r2);



%% SENSIBILIDADES
% vars = [G; w0; Q];
% params = [r1, r2, r3, r4, ra, rb, c1, c2];
s = [[                                                                                                                                                                                                                                                                                                                                                                                          -(r1*((c1/c2 + 1)/r2 - rb/(r3*ra)))/((r1*(c1/c2 + 1))/r2 - (r1*rb)/(r3*ra) + 1),                                                                                                                               (r1*(c1/c2 + 1))/(r2*((r1*(c1/c2 + 1))/r2 - (r1*rb)/(r3*ra) + 1)),                                                                                                                                                                                                          -(r1*rb)/(r3*ra*((r1*(c1/c2 + 1))/r2 - (r1*rb)/(r3*ra) + 1)), 0, -(ra*rb*(c1*r1*r3 + c2*r1*r2 + c2*r1*r3 + c2*r2*r3))/((ra + rb)*(c1*r1*r3*ra + c2*r1*r3*ra + c2*r2*r3*ra - c2*r1*r2*rb)), (ra*rb*(c1*r1*r3 + c2*r1*r2 + c2*r1*r3 + c2*r2*r3))/((ra + rb)*(c1*r1*r3*ra + c2*r1*r3*ra + c2*r2*r3*ra - c2*r1*r2*rb)),                                                                                                                                   -(c1*r1)/(c2*r2*((r1*(c1/c2 + 1))/r2 - (r1*rb)/(r3*ra) + 1)),                                                                                                                                     (c1*r1)/(c2*r2*((r1*(c1/c2 + 1))/r2 - (r1*rb)/(r3*ra) + 1))];...
[                                                                                                                                                                                                                                                                                                                                                                                                                                                        -r3/(2*(r1 + r3)),                                                                                                                                                                                            -1/2,                                                                                                                                                                                                                                                     -r1/(2*(r1 + r3)), 0,                                                                                                                        0,                                                                                                                       0,                                                                                                                                                                                           -1/2,                                                                                                                                                                                            -1/2]; ...
[ -(r1*(((r1/r3 + 1)^(1/2)*(c1/(2*c2*r2*((c1*r1)/(c2*r2))^(1/2)) - (rb*((c2*r2)/(c1*r1))^(1/2))/(r3*ra) + (c2*r2*((r1*rb)/(r3*ra) - 1))/(2*c1*r1^2*((c2*r2)/(c1*r1))^(1/2))))/(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1)^2 - 1/(2*r3*(r1/r3 + 1)^(1/2)*(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1)))*(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1))/(r1/r3 + 1)^(1/2), (r2*((c2*((r1*rb)/(r3*ra) - 1))/(2*c1*r1*((c2*r2)/(c1*r1))^(1/2)) + (c1*r1)/(2*c2*r2^2*((c1*r1)/(c2*r2))^(1/2))))/(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1), -(r1*(r3*ra + r3*ra*((c1*r1)/(c2*r2))^(1/2) + r3*ra*((c2*r2)/(c1*r1))^(1/2) + r1*rb*((c2*r2)/(c1*r1))^(1/2) + 2*r3*rb*((c2*r2)/(c1*r1))^(1/2)))/(2*(r1 + r3)*(r3*ra + r3*ra*((c1*r1)/(c2*r2))^(1/2) + r3*ra*((c2*r2)/(c1*r1))^(1/2) - r1*rb*((c2*r2)/(c1*r1))^(1/2))), 0,   -(r1*rb*((c2*r2)/(c1*r1))^(1/2))/(r3*ra*(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1)),   (r1*rb*((c2*r2)/(c1*r1))^(1/2))/(r3*ra*(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1)), -(c1*(r1/(2*c2*r2*((c1*r1)/(c2*r2))^(1/2)) + (c2*r2*((r1*rb)/(r3*ra) - 1))/(2*c1^2*r1*((c2*r2)/(c1*r1))^(1/2))))/(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1), (c2*((r2*((r1*rb)/(r3*ra) - 1))/(2*c1*r1*((c2*r2)/(c1*r1))^(1/2)) + (c1*r1)/(2*c2^2*r2*((c1*r1)/(c2*r2))^(1/2))))/(((c1*r1)/(c2*r2))^(1/2) - ((r1*rb)/(r3*ra) - 1)*((c2*r2)/(c1*r1))^(1/2) + 1)]];
 